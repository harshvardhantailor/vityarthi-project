
import pandas as pd
import os
from datetime import datetime
def load_expenses():
    if os.path.exists('expenses.csv'):
        return pd.read_csv('expenses.csv')
    else:
        return pd.DataFrame(columns=['Date', 'Category', 'Description', 'Amount'])
def save_expenses(df):
    df.to_csv('expenses.csv', index=False)
def add_expense(df):
    date_str = input("Date (YYYY-MM-DD): ").strip()
    category = input("Category: ").strip()
    description = input("Description: ").strip()
    while True:
        try:
            amount = float(input("Amount: ").strip())
            break
        except ValueError:
            print("Please enter a valid number for amount.")
    new_expense = pd.DataFrame({
        'Date': [date_str],
        'Category': [category],
        'Description': [description],
        'Amount': [amount]
    })
    updated_df = pd.concat([df, new_expense], ignore_index=True)
    save_expenses(updated_df)
    print("Expense added successfully!")
def view_expenses():
    df = load_expenses()
    if df.empty:
        print("No expenses recorded yet.")
    else:
        print(df.to_string(index=False))
def generate_report():
    df = load_expenses()
    if df.empty:
        print("No expenses to report.")
        return
    df['Date'] = pd.to_datetime(df['Date'])
    print("\n1. Total by Category")
    print("2. Monthly Summary")
    choice = input("Choose report type (1 or 2): ").strip()
    if choice == '1':
        category_totals = df.groupby('Category')['Amount'].sum()
        print("\nTotal Expenses by Category:")
        print(category_totals)
    elif choice == '2':
        df['Month'] = df['Date'].dt.to_period('M')
        monthly_totals = df.groupby('Month')['Amount'].sum()
        print("\nMonthly Expense Summary:")
        print(monthly_totals)
    else:
        print("Invalid choice.")
def main():
    while True:
        print("\nPersonal Finance Tracker")
        print("1. Add Expense")
        print("2. View Expenses")
        print("3. Generate Report")
        print("4. Exit")
        choice = input("Choose an option: ").strip()
        if choice == '1':
            df = load_expenses()
            add_expense(df)
        elif choice == '2':
            view_expenses()
        elif choice == '3':
            generate_report()
        elif choice == '4':
            print("Goodbye!")
            break
        else:
            print("Invalid option. Try again.")

if __name__ == "__main__":
    main()
